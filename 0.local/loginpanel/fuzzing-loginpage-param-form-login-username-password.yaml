id: fuzzing-loginpage-param-form-login-username-password

info:
  name: fuzzing-loginpage-param-form-login-username-password
  author: capiton
  severity: info

requests:
  - raw:
      - |-
        POST {{path}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Origin: {{RootURL}}
        Referer:  {{RootURL}}

        {{user_param}}={{randstr}}&{{pass_param}}={{randstr}}
    # threads: 10
    redirects: true
    max-redirects: 1
    payloads:
      path:
        - ""
        - / 
        - /login
        - /login.do
        - /a/login
        - /signin
        - /login/
        - /login.html 
        - /login.cgi 
        - /accounts/login
        - /data/login 
        - /submitLogin
        - /login.php
        - /login/dologin
        - /api/tokens
        - /index/login.cgi
        - /cgi-bin/login.cgi
        - /webadmin/index.php
        - /login/verify
        - /control/login
        - /users/login
        - /login.php
        - /login.jsp
        - /login.aspx
        - /admin/login
        - /admin/login.do
        - /admin/login.php
        - /loginCheck.action
        - /index.php?s=/store/passport/login

        
      user_param:
        - username
        - account
        - userName
        - name
        - Username
        - user
        - loginUsername
        - u
        - user_name
        - j_username
        - USERNAME
        - Name
        - login_id
        - id
        - LoginCode
        - User[user_name]

      pass_param:
        - password
        - pass
        - pwd
        - user_pwd
        - userPassword
        - psw
        - Password
        - loginPassword
        - p
        - user_password
        - j_password
        - PASSWORD
        - Pass
        - passwd
        - login_pw
        - LoginPassword
        - User[password]


    attack: clusterbomb
    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        condition: or
        words:
          - "用户名密码错误"
          - "用户名或密码错误"
          - "用户或密码错误"
          - "密码错误"
          - "密码不对"
          - "用户不存在/密码错误"
          - "登陆失败, 账号或密码错误"
          - "login fail"
          - "password error"
          - "用户名或密码无效"
          - "用户名或密码不正确"
          - "无效的用户名或密码"
          - "不合法的账号密码"
          - "登录失败，请重试"
          - "帐号不存在或密码错误"

