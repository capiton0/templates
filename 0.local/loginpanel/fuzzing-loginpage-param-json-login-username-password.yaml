id: fuzzing-loginpage-param-json-login-username-password

info:
  name: fuzzing-loginpage-param-json-login-username-password
  author: capiton
  severity: info

requests:
  - raw:
      - |-
        POST {{path}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json; charset=UTF-8

        {"{{user_param}}":"{{randstr}}","pass_param":"{{randstr}}"}

    redirects: true
    max-redirects: 1
    payloads:
      path:
        - /login
        - /api/user/login

        
      user_param:
        - username
        - user
        - account

      pass_param:
        - password
        - pass
        - pwd
        # - user_pwd


    attack: clusterbomb
    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        condition: or
        words:
          - "用户名密码错误"
          - "用户名或密码错误"
          - "用户或密码错误"
          - "密码错误"
          - "密码不对"
          - "用户不存在/密码错误"
          - "登陆失败, 账号或密码错误"
          - "login fail"
          - "password error"
          - "用户名或密码无效"
          - "用户名或密码不正确"
          - "无效的用户名或密码"
          - "不合法的账号密码"
          - "登录失败，请重试"

